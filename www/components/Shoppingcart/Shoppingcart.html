<div id="Shoppingcart">
    <ion-view>
        <ion-content>
            <ion-refresher pulling-text="Pull to refresh..." on-refresh="Test()">
            </ion-refresher>
            <div id="logo">
                <!-- ProductImageUrl , ProductImages-->
                <img id="productimages" ng-src="{{ businessData.Image == null || businessData.Image == '' ? 'img/placeholder.jpg' : businessData.Image }}">
                <div class="detail-banner-left">
                    <div class="detail-banner-info text-left">
                        <!-- <div class="detail-label">Restaurant</div> -->
                        <div class="detail-verified {{ businessData.StatusName == 'Live' ? '' : 'redBack' }}">{{ businessData.StatusName == "Live" ? "Verified" : "Not Verified" }}</div>
                    </div>
                    <!-- /.detail-banner-info -->
                    <h2 class="detail-title text-left">{{ businessData.Name }}</h2>
                    <div class="detail-banner-address text-left">
                        <i class="famap"></i> {{ businessData.Address1 }}
                    </div>
                    <!-- /.detail-banner-address -->
                    <div class="row reviews-star" ng-bind-html=roothelperFunction.print_stars(businessData.Reviews)></div>
                    <!-- /.detail-banner-rating -->
                </div>
            </div>
            <div class="row">
                <p class="row fontsize">Shopping Cart</p>
            </div>

            <!-- Start : After checkout data -->
            <div ng-show="cart.checkout_data"><!--  -->
                <div class="row">
                    <div class="col col-33">
                        <b>1. Shipping address</b>
                    </div>
                    <div class="col">
                        {{ cart.checkout_data.UserDefaultAddress.StreetAddress+', '+cart.checkout_data.UserDefaultAddress.City }}
                    </div>
                    <!-- <div class="col">
                        <button id="btnaddress" class="btn btn-default" ng-click="cart.ChangeAddress()">Change</button>
                    </div> -->
                </div>
                <div class="row">
                    <div class="col col-33">
                        <p style="font-weight: bold; margin-top: 20px;">2. Payment method</p>
                    </div>
                    <div class="col">
                        <div class="row" ng-repeat="(key, value) in cart.paystack_auth_code" style="margin-top: 0px;">
                            <div class="col col-10">
                                <input type="radio" ng-model="cart.payment_method" name="Paymentmethod" value="{{ key+3 }}" id="rdPayStack{{ key+3 }}" style="margin-top: 4px;">
                            </div>
                            <div class="col">
                                <label for="rdPayStack{{ key+3 }}">Last Digit : {{ value.PaystackCCLastFour }}, Card Type : {{ value.PaystackCardType }}</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-10">
                                <input type="radio" ng-model="cart.payment_method" name="Paymentmethod" value="1" id="rdPayStack">
                            </div>
                            <div class="col">
                                <label for="rdPayStack"><img src="img/paystack.PNG" class="paymentimage"></label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-10">
                                <input type="radio" ng-model="cart.payment_method" name="Paymentmethod" value="2" style="margin-top: 4px;" id="rdGtPay">
                            </div>
                            <div class="col">
                                <label for="rdGtPay"><img src="img/gtpay.PNG"></label>
                            </div>
                        </div>
                    </div>
                    <!-- Start : gtPayment -->
                    <form id="TheForm" name="submit2gtpay_form" action="https://ibank.gtbank.com/GTPay/Tranx.aspx" target="TheWindow" method="post">
                        <input type="hidden" name="gtpay_mert_id"        value="{{ gtbank.gtpay_mert_id }}" />
                        <input type="hidden" name="gtpay_tranx_id"       value="{{ gtbank.gtpay_tranx_id }}" />
                        <input type="hidden" name="gtpay_tranx_amt"      value="{{ gtbank.gtpay_tranx_amt }}" />
                        <input type="hidden" name="gtpay_tranx_curr"     value="{{ gtbank.gtpay_tranx_curr }}" />
                        <input type="hidden" name="gtpay_cust_id"        value="{{ gtbank.gtpay_cust_id }}" />
                        <input type="hidden" name="gtpay_cust_name"      value="{{ gtbank.gtpay_cust_name }}" />
                        <input type="hidden" name="gtpay_echo_data"      value='{{ gtbank.local_oauth_url }}' />
                        <input type="hidden" name="gtpay_gway_name"      value="" />
                        <input type="hidden" name="gtpay_hash"           value="{{ gtbank.HashCode }}" />
                        <!-- <input type="hidden" name="gtpay_hash"           value="4994123456785245214000566236http://beta2.loyalbonus.com/UserCart/OrderConfirmationMobileD3D1D05AFE42AD50818167EAC73C109168A0F108F32645C8B59E897FA930DA44F9230910DAC9E20641823799A107A02068F7BC0F4CC41D2952E249552255710F" /> -->
                        <input type="hidden" name="gtpay_tranx_noti_url" value="{{ gtbank.oauthUrl }}" />
                        <input type="submit" value="Pay Via GTPay"       name ="btnSubmit" style="display: none;" />
                    </form>
                    <!-- End : gtPayment -->
                </div>
            </div>
            <!--- End : After checkout data -->

            <div class="">
                {{ cart.checkout_error }}
            </div>

            <div class="padding">
                <div class="brder" ng-hide="cart.hide_everything">
                    <div class="row position_relative_item" ng-show="cart.data.UserCartDetailPromos.length == 0 ? false : true " ng-repeat="(key, product) in cart.data.UserCartDetailPromos">
                        <div class="col-40"><img id="shoppingimg" ng-src="{{ product.DefaultImage }}"></div>
                        <div class="col-60">
                            <span class="shoppingdesciption" style="width: 100%">{{ product.ProductName }} <i class="color33cd5f">₦{{ product.PriceAfterBusinessDiscount }}</i></span>
                            <label class="shoppingsmall">{{ product.LoyaltyDiscount }}% Loyalty discount <i style="    text-decoration: line-through; color: red;">₦{{ product.Price }}</i></label>
                            <div class="row paddingLeftRight-0">
                                <div class="col-50">
                                    <span class="shoppingqty"> QTY: </span>
                                    <input type="text" class="qty" name="qty" ng-change="cart.quantity_change(product.CartDetailId, product.ProductId, product.Qty)" ng-model="cart.data.UserCartDetailPromos[key].Qty" placeholder="1">
                                </div>
                                <div class="col-50">
                                    <!-- <button class="button offersshopping">2 Offers</button> -->
                                </div>
                            </div>
                        </div>
                        <i class="ion-close icon_close_position_absolute" ng-click="cart.remove_product(product.CartDetailId, product.CartId, cart.data.BusinessStoreId, product.ProductId, key)"></i>
                    </div>

                    <div class="bordertop">
                        <div class="center">
                            <ion-item class="wth-border item ng-binding color33cd5f"> ₦ {{ cart.totalPrice().price_after_discount_full }}</ion-item>
                        </div>
                        <div class="row">
                            <div class="col-50 col-offset-10">
                                <span class="shoppingloyality" ng-show="cart.data.PromoId > 0 && cart.checkout_data">{{ cart.checkout_data.Promo.PercentageDiscount ? cart.checkout_data.Promo.PercentageDiscount+'% discount' : cart.checkout_data.Promo.MoneyOffDiscount+' Money off discount' }}</span>
                            </div>
                            <div class="col-50 text-right" style="color: red; padding-right: 30px;">
                                <!-- <ion-item class="redcolor"></ion-item> -->
                                ₦{{ cart.totalPrice().total_price_full }}
                            </div>
                        </div>
                    </div>
                    <div class="bordertop">
                        <div class="row">
                            <div class="col-50">
                                <input class="promoCart pull-left center margin-top-15" ng-show="cart.checkout_data ? false : true" type="text" ng-model="cart.promo" ng-disabled="cart.data.PromoId > 0 ? true : false"><!--enable when promoId is greater than 0-->

                                <span class="subtotal col pull-left center margintop20">Sub-Total</span>
                                <span class="subtotal col pull-left  margintop center"> ₦ {{ cart.totalPrice().price_after_discount_full }}</span>
                            </div>
                            <div class="col-50">
                                <button class="button applypromo margintop15 button-block" ng-show="cart.checkout_data ? false : true" ng-click="cart.apply_promo()">{{ cart.data.PromoId > 0 ? 'Remove Promo' : 'Apply Promo' }}</button><!--apply_promo has functionality to remove promo-->
                                <button class="button checkoutbutton button-block" ng-click="cart.checkout_data ? cart.payment(cart.payment_method) : cart.check_out()">{{ cart.checkout_data ? 'Order' : 'Checkout' }}</button>
                                <button class="button button-balanced continueshoppingbutton button-block" ui-sref="home.product({ BusinessId : cart.state_on() })">Continue Shopping</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div ng-show="cart.hide_everything">
                    Please add items to cart.
                </div>
            </div>
        </ion-content>
        <ion-footer-bar class="footer-bar-custom bar-positive">
            <div class="title center" on-tap="userPresent() == 1 ? scanBarcode() : helperFunction.go_to_login()">{{ userPresent() == 1 ? 'SCAN NOW' : 'LOGIN' }}</div>

        </ion-footer-bar>
    </ion-view>
</div>